<!DOCTYPE html>

<script>
function get_notes() {
	const url = "http://localhost:5000/get-notes"
	fetch(url).then(function(response) { 
		return response.json()
	}).then(function(data) {
		print_notes(data)
	})
}

function add_note(form) {
	const url = "http://localhost:5000/add-note"
	const xhr = new XMLHttpRequest()
	const content = JSON.stringify({content: document.getElementById("content").value})
	xhr.open("POST", url, true)
	xhr.setRequestHeader("Content-Type", "application/json")
	xhr.setRequestHeader("Access-Control-Allow-Origin", "*")
	xhr.send(content)
	xhr.onreadystatechange = (e) => {
		console.log(xhr.responseText)
		get_notes()
	}
}

function print_notes(data) {
	for (const node of document.querySelectorAll("li")) {
		document.querySelector("ul").removeChild(node)
	}
	for (const note of data) {
		var node = document.createElement("li")
		node.appendChild(document.createTextNode(note.note))
		document.querySelector("ul").appendChild(node)
	}
	console.log(document.querySelectorAll("li"))
}

function remove_note() {
}

function edit_note() {
}
</script>

<html>
	<head>
		<title>Note manager (HTML version)</title>
	</head>
	<body>
	<h1>Note manager (HTML version)</h1>
	<h2>Add new note</h2>
		<form name="new-note" action="javascript:add_note(this.form)">Note:
			<input type="text" id="content" name="content">
			<input type="submit" value="Submit">
		</form>
	</body>
	<h2>All notes</h2>
	<ul>
	</ul>

	<script>
	get_notes()
	</script>

</html>
